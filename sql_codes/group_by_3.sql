SELECT 
CITY,
SUM(TOTALPRICE) AS TOTALSALE,
COUNT(DISTINCT CUSTOMERCODE) AS CUSTOMERCOUNT
FROM SALES
WHERE REGION = 'MARMARA'
GROUP BY CITY
HAVING COUNT(DISTINCT CUSTOMERCODE) > 100
ORDER BY 3 DESC